OLTP，在线事务处理

数据量不大

OLAP，	联机分析

离线，数据量不大，提供决策支撑，实时性不高，

业务系统：客户表，订单表，等

数据库的设计，表与表的关系

关系对应这表

每一个属性都有范围，比如月份，性别，拒绝不合理的值

元祖：一个行，一条记录

关系性数据库，三范式

键;主外键，约束关系完整性

超件，候选键

主键的原则：小，不应该改变，一般没什么含义，通常是int型，最好是单列

做一个自增，比较好，一般没什么意义

局部更新和删除方便

主外键的约束

聚集索引：一般默认是主键，时间字段用的比较多，比较移动查话费

属性与属性域

区别：

关系完整性

实体完整性

参照完整性：主键有，外键的数据不该存在





范式

选课

部分依赖不满足第二范式

要满足要单独拿出一个表

第三范式

非主属性，不能依赖，比如教师名和职称

范式越大，表的数量越大，查询join越多，数据量多的话，影响

所以优化砍表，分表，分状态。

数据库设计规范

1、命名规范

tmp_

读写分离，一个主写，多个备读，

主库采用innodb

备库 myisam

国内大部分用utf-8 v，默认latin-1，看业务

建表必须要有添加注释，类似代码的备注

尽量控制单表数据，500万行，如果太大，分库，分表

mysql分区表现为多个文件

hive表现为多个子目录

冷热分离，热数据放在内存中

类似与hbase  membrary

减少表的宽度

mysql单行数据，8096byte

禁止使用预留字段 

三种环境,开发，测试，线上数据库

禁止从开发环境。连接生产数据库

索引规范

索引可以提高查询效率，但是会降低插入和更新效率

不能使用uuid,md5,hask字符串。作为主键，使用自增定长。

在那些列建立索引 slelect,delete,update的where从句的列

建立索引要考虑查询条件

65536

枚举就是特殊的字符串



prepareStatment预编译

充分利用已存在索引

不同数据库使用不同账号

禁止使用select * ，先读元数据再去查数据

新版m

or不利用索引

union　all 与　union区别

前者不会去去重

后者去重排序

一个sql只能使用一个cpu,不支持并行计算

数据库操作行为规范

锁表～

名字vachar(20)不够

常用的十种模型

## 数据仓库

### 数据仓库的特点

①面向主题

```
面向主题：将不同的业务或者操作平台的相同主题存储下来，比如销售数据仓库，就把各个业务部门的销售数据拉取数据，但是生产数据库就不是此主题下的

为特定的数据分析领域	与目标提供数据支持
多个子模块会共同会用到的数据，抽取出来，
数据仓库随着主题变换
面向主题白包括了该主题的所有信息	
不同主题有重叠内容在DW
超过１００张建立库，跨库操作，少的话不用建库

```



②集成 

```
面向主题与集成有关联，将各个业务部门的销售数据集成在一起，需要将各个分散的数据统一成无歧义，一致的数据格式，在存储到数据仓库中
例如：例如字段的同名异意、异名同意、字段数据类型不一致，长度不一致，计量单位不一致等等。另外数据还需要进行综合和计算等处理。当完成了这些数据的整合工作后，数据仓库就是集成的，这个过程就是数据仓库中最复杂、最关键的过程：ETL。集成也就是把多个数据源的数据进行统一存储到数据仓库中。	
```

③非易失 

```
数据进入到数据仓库就不发生变化，数仓的目的就是对历史数据进行分析，数据不可修改
```

④变化

```
数据仓库中的数据有自己的生存周期，过期后就会移除。
数据仓库是OLAP（联机分析的处理）与之对应的是OLTP（联机事务处理），OLTP一般处理的是对实时性要求比较高的业务，反应的是当前时间点的业务情况，对高并发，高性能能在极短的时间反应。所以在OLTP中会按照活跃等级划分，将活跃度较低的数据存入到数据库中，这也就是我们常说的热库与冷库。
```

⑤粒度

```
粒度是指数据的细化和综合的程度，细化程度越高，粒度级别就越低，例如，单个事务是低粒度级别的，而一个月事务的汇总就是高粒度级别。
根据数据仓库的大小来划分粒度。
高粒度：用户电话单总结表
低粒度:用户这个月电话单详情表
```

### 建立数据仓库的必要性

```
①分析安全
②减轻业务数据库的压力
③没有适当的方式将有价值的数据合并进特定应用的数据库
还有很多
```

### 操作型系统（OLTP）与分析型系统(OLAP)

OLTP：联机事务处理（on-line transaction procession） 处理最近基本的事务，比如数据库的增删改查

特点

```
①实时性
②数据量小，会及时做出数据的处理的转移
③高并发并且满足ACID原则
④数据是确定

补充：ACID见数据库基本知识的事务介绍
```

OLAP：联机分析处理OLAP（On-Line Analytical Processing） 是数据仓库系统的主要应用，支持复杂的分析操作，侧重决策支持，并且提供直观易懂的查询结果。典型的应用就是复杂的动态的报表系统。

特点

```
1.实时性要求不是很高，比如最常见的应用就是天级更新数据，然后出对应的数据报表。 
2.数据量大，因为OLAP支持的是动态查询，所以用户也许要通过将很多数据的统计后才能得到想要知道的信息，例如时间序列分析等等，所以处理的数据量很大; 
3.OLAP系统的重点是通过数据提供决策支持，所以查询一般都是动态，自定义的。所以在OLAP中，维度的概念特别重要。一般会将用户所有关心的维度数据，存入对应数据平台。
```

### ETL

ETL实现有三种方式

```
①是借助ETL工具(如Oracle的OWB、SQL Server 2000的DTS、SQL Server2005的SSIS服务、Informatic等)实现，
②SQL方式实现，
③ETL工具和SQL相结合。
总结：前两种方法各有各的优缺点，借助工具可以快速的建立起ETL工程，屏蔽了复杂的编码任务，提高了速度，降低了难度，但是缺少灵活性。
SQL的方法优点是灵活，提高ETL运行效率，但是编码复杂，对技术要求比较高。
综合了前面二种的优点，会极大地提高ETL的开发速度和效率。
```

#### ①Extract

在数据的抽取也分为三种

```
①业务数据源与数据仓库源一致，直接进行连接
②DW的数据来自于不同的数据源，转成文件在导入
③对于文件直接导入
注意：对于增量更新的问题，业务数据库会保存业务数据发生的时间，然后在ods层中记录最大的时间，然后去业务系统中取这个大于这个时间戳的数据。
```

#### ②数据的清洗与转换（Cleaning，Transform）

**cleaning**

这个阶段主要有三种清洗的数据

```sql
①不完整数据：应该有的数据没有，将数据过滤出来，写入excel中，交给业务部门补全数据，在写入数据库中
②错误的数据：日期格式不正确，字符串有回车等都要分类提取出来，不然会导致ETL失败，让业务部门去修正
③重复的数据：对于这一类数据——特别是维表中会出现这种情况——将重复数据记录的所有字段导出来，让客户确认并整理。
```

Transform

```
数据转换的任务主要进行不一致的数据转换、数据粒度的转换，以及一些商务规则的计算。
 (1)不一致数据转换：这个过程是一个整合的过程，将不同业务系统的相同类型的数据统一，比如同一个供应商在结算系统的编码是XX0001,而在CRM中编码是YY0001，这样在抽取过来之后统一转换成一个编码。
 (2)数据粒度的转换：业务系统一般存储非常明细的数据，而数据仓库中数据是用来分析的，不需要非常明细的数据。一般情况下，会将业务系统数据按照数据仓库粒度进行聚合。
 (3)商务规则的计算：不同的企业有不同的业务规则、不同的数据指标，这些指标有的时候不是简单的加加减减就能完成，这个时候需要在ETL中将这些数据指标计算好了之后存储在数据仓库中，以供分析使用。
```

​	

###  **数据仓库设计基础、维表和事实表技术**







数据建模

数据仓库，迭代式开发，基于过程

